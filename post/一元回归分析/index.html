<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.89.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>SPSS-一元回归分析&nbsp;&ndash;&nbsp;SayuriBlog</title><link rel="stylesheet" href="/css/core.min.648a6d12e2a3dde16e849ff7df9be3ae5560eafe1a16f581e9555eea238e863fe56d7308f54ae31f49106dd309b237eb.css" integrity="sha384-ZIptEuKj3eFuhJ/335vjrlVg6v4aFvWB6VVe6iOOhj/lbXMI9UrjH0kQbdMJsjfr"><body>
    <div class="base-body"><code class="html"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css"/></code>
<section id="header" class="site header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><img class="site logo" src="/img/logo.jpg" alt /><span class="site name">SayuriBlog</span></a></span>
        <span class="header right-side"></span></div></section><div id="content"><section class="article header">
    <h1 class="article title">SPSS-一元回归分析</h1><p class="article date">Monday, April 12, 2021</p></section><article class="article markdown-body"><h3 id="回归分析简介">回归分析简介</h3>

<p>回归分析(Regression)是一种应用极为广泛的统计分析方法，成功应用在金融，经济，管理等领域。它用于分析事物之间的统计关系，侧重考察变量之间的变化规律，并通过回归模型形式描述和反映这种关系。</p>

<p>线性回归分析Linear Regression 是研究一个因变量和一个或多个自变量之间是否存在某种线性关系的统计学方法。若自变量的个数为1，则为一元线性回归分析。若为n(n&gt;1)为多元回归分析。</p>

<p>回归分析与相关分析具有相似之处，其不同在于相关分析主要反映变量间线性关系的密切程度，而回归分析主要反映自变量取值大小对因变量的取值的影响程度。</p>

<h3 id="一元回归分析的数学模型">一元回归分析的数学模型</h3>

<p>假设收集到<span  class="math">\(n\)</span>对数据<span  class="math">\(x_i,y_i(i=1,2,...,n)\)</span>，<span  class="math">\(x_i\)</span>认为是来自于随机变量<span  class="math">\(X\)</span>的一组样本值，<span  class="math">\(y_i\)</span>认为是来自于<span  class="math">\(Y\)</span>的一组样本统计值。回归分析探讨<span  class="math">\(Y\)</span>和<span  class="math">\(X\)</span>在统计意义下的相互关系。其中<span  class="math">\(X\)</span>和<span  class="math">\(Y\)</span>分别被称为自变量和因变量。</p>

<p>一元回归分析的数学模型为：</p>

<p><span  class="math">\[
y=a + bx + \varepsilon
\]</span></p>

<p>其中<span  class="math">\(a\)</span>为回归常数，<span  class="math">\(b\)</span>为回归系数，<span  class="math">\(\varepsilon\)</span>为随机误差。<span  class="math">\(y\)</span>的变化由两部分解释：</p>

<ul>
<li><p><span  class="math">\(x\)</span>的变化引起<span  class="math">\(y\)</span>的线性变化部分，即<span  class="math">\(y = a + bx\)</span></p></li>

<li><p>其他随机因素引起的y的变化部分<span  class="math">\(\varepsilon\)</span></p></li>
</ul>

<p>回归模型的建立要满足随机误差的数学期望为0，且随机误差的方差为一个特定常数。即有<span  class="math">\(E ( \varepsilon ) = 0 , \operatorname { var } ( \varepsilon ) = \delta ^ { 2 }\)</span>。如果对回归模型求期望值，则有<span  class="math">\(E(y) = a + bx\)</span>。</p>

<p>一元线性回归模型的建立通常使用最最小二乘法。该方法的基本思路为：根据从总体中随机抽出的一个样本，在平面直角坐标系中找到一条直线，使得观测值<span  class="math">\(y_i\)</span>与拟合值<span  class="math">\(\hat y_i\)</span>之间的距离最短，即两这之间的残差的平方和最小。公式可表示为：</p>

<p><span  class="math">\[
D = \sum _ { i = 1 } ^ { n } e _ { i } ^ { 2 } = \sum _ { i = 1 } ^ { n } \left( y _ { i } - \hat { y } _ { i } \right) ^ { 2 } = \sum _ { i = 1 } ^ { n } \left( y _ { i } - a - bx _ { i } \right) ^ { 2 }
\]</span></p>

<p>要使上述式子取得最小，可以分别对<span  class="math">\(a,b\)</span>求导，得到：</p>

<p><span  class="math">\[
\begin{array} { l } \frac { \partial D } { \partial a } = - 2 \sum _ { i = 1 } ^ { n } \left( y _ { i } - a - b x _ { i } \right) = 0 \\ \frac { \partial D } { \partial b } = - 2 \sum _ { i = 1 } ^ { n } x _ { i } \left( y _ { i } -a - bx _ { i } \right) = 0 \end{array}
\]</span></p>

<p>因此可以解得：</p>

<p><span  class="math">\[
\begin{array} { c } a = \frac { \sum x _ { i } ^ { 2 } \sum y _ { i } - \sum x _ { i } \sum x _ { i } y _ { i } } { n \sum x _ { i } ^ { 2 } - \left( \sum x _ { i } \right) ^ { 2 } } \\ b = \frac { n \sum x _ { i } y _ { i } - \sum x _ { i } \sum y _ { i } } { n \sum x _ { i } ^ { 2 } - \left( \sum x _ { i } \right) ^ { 2 } } = \frac { \sum \left( x _ { i } - \bar { x } \right) \left( y _ { i } - \bar { y } \right) } { \sum \left( x _ { i } - \bar { x } \right) ^ { 2 } } \end{array}
\]</span></p>

<p>可以看出，回归斜率系数的估计值实际上等于自变量和因变量之间的样本协方差与自变量的样本方差之比。</p>

<h3 id="回归方程的统计检验">回归方程的统计检验</h3>

<p>我们利用最小二乘法获得回归系数及相应的回归方程。至于<span  class="math">\(x\)</span>和<span  class="math">\(y\)</span>之间是否真有如回归模型所描述的关系，或者说采用所得的回归模型去拟合实际数据是否有足够好的近似。还需得到进一步的判明。</p>

<p>我们需要对回归模型描述实际数据的近似程度，即对所得的回归模型的可信程度进行检验。包括回归方程的拟合优度检验，回归方程的显著性检验，回归系数的显著性检验以及残差分析等。</p>

<h4 id="回归方程的拟合优度检验">回归方程的拟合优度检验</h4>

<p>拟合优度检验样本数据点聚集在回归线周围的密集程度。从而评价回归方程对样本数据的代表程度。其中统计量为<span  class="math">\(R^2\)</span>统计量，称为判定系数：</p>

<p><span  class="math">\[
R ^ { 2 } = \frac { \sum _ { i = 1 } ^ { n } \left( \widehat { y _ { i } } - \bar { y } \right) ^ { 2 } } { \sum _ { i = 1 } ^ { n } \left( y _ { i } - \bar { y } \right) ^ { 2 } } = 1 - \frac { \sum _ { i = 1 } ^ { n } \left( y _ { i } - \widehat { y } \right) ^ { 2 } } { \sum _ { i = 1 } ^ { n } \left( y _ { i } - \bar { y } \right) ^ { 2 } }
\]</span></p>

<p>如果采用单因素方差分析中的解释，即回归方程中总变差为<span  class="math">\(SST=SSA+SSE\)</span>，则有<span  class="math">\(R^2=SSA/SST\)</span>。其反映的是回归方程所能解释的变差的比例。</p>

<p>对于一元线性方程，<span  class="math">\(R^2\)</span>也是<span  class="math">\(y\)</span>与<span  class="math">\(x\)</span>简单相关系数<span  class="math">\(R\)</span>的平方：</p>

<p><span  class="math">\[
R = \frac { \sum _ { i = 1 } ^ { n } \left( x _ { i } - \bar { x } \right) \left( y _ { i } - \bar { y } \right) } { \sqrt { \sum _ { i = 1 } ^ { n } \left( x _ { i } - \bar { x } \right) ^ { 2 } \sum _ { i = 1 } ^ { n } \left( y _ { i } - \bar { y } \right) ^ { 2 } } }
\]</span></p>

<p><span  class="math">\(R^2\)</span>的取值范围为0到1，其值约接近于1，则表明模型的解释性越强，在一元线性方程中也表示自变量与因变量的线性关系越强。</p>

<h4 id="回归方程整体显著性检验">回归方程整体显著性检验</h4>

<p>其检验因变量<span  class="math">\(Y\)</span>与自变量<span  class="math">\(X\)</span>之间的<strong>线性关系</strong>是否显著，用线性模型来描述它们之间的关系是否恰当，即进行整体回归效果的检验。回归方程的显著性检验采用方差分析的方法。对于<span  class="math">\(SST=SSA+SSE\)</span>的方差分析形式，研究<span  class="math">\(y\)</span>的<span  class="math">\(SST\)</span>中模型可解释部分<span  class="math">\(SSA\)</span>相对于随机误差部分<span  class="math">\(SSE\)</span>是否占较大的比例。</p>

<p>整体回归效果检验采用<span  class="math">\(F\)</span>统计量：</p>

<p><span  class="math">\[
F = \frac { S S A } { S S E } = \frac { \sum _ { i = 1 } ^ { n } \left( \hat { y } _ { i } - \bar { y } \right) ^ { 2 } } { \sum _ { i = 1 } ^ { n } \left( y _ { i } - \hat { y } _ { i } \right) ^ { 2 } / ( n - 2 ) }
\]</span></p>

<p>统计量<span  class="math">\(F\)</span>的值越大越好，当计算出的值<span  class="math">\(F > F_\alpha(1, n-2)\)</span>时，就表明在<span  class="math">\(\alpha\)</span>水平上，已解释方差明显大于未解释方差。</p>

<h4 id="回归系数的显著性检验">回归系数的显著性检验</h4>

<p>主要目的是研究回归方程中的每个自变量与因变量之间是否存在显著地线性关系，即研究自变量能否有效地解释因的线性变化，他们能否保留在线性回归模型中。</p>

<p>一元线性回归使用T检验来验证回归系数的显著性。其原假设为回归系数<span  class="math">\(b=0\)</span>。统计量为：</p>

<p><span  class="math">\[
\mathrm { T } = \frac { \mathrm { b } } { \frac { \hat { \sigma } } { \sqrt { \sum _ { \mathrm { i } = 1 } ^ { \mathrm { n } } \left( \mathrm { x } _ { \mathrm { i } } - \overline { \mathrm { x } } \right) ^ { 2 } } } }
\]</span></p>

<p>其中有：</p>

<p><span  class="math">\[
\hat { \sigma } ^ { 2 } = \frac { 1 } { n - 2 } \sum _ { i = 1 } ^ { n } \left( y _ { i } - \hat { y } _ { i } \right) ^ { 2 }
\]</span></p>

<p>该统计量服从n-2个自由度的t分布。</p>

<p>对回归系数t统计量的显著性检验，决定了相应的变量能否作为解释变量进入回归方程。当b=0假设成立，意味着x的变化不会引起y的线性变化，x无法解释y，它们之间不存在线性关系, x不能进入回归模型。在一元线性回归分析中，回归方程显著性检验和回归系数显著性检验的作用是相同的，两者可以相互替代。注意，当检验结果没能拒绝原假设时，我们也不能得出自变量与因变量没有关系的结论。因为X与Y之间还可能存在曲线关系。</p>

<h3 id="spss中的线性回归分析">SPSS中的线性回归分析</h3>

<p>通常来说，需要先使用<code>图形-图标构建程序</code>画出散点图与拟合直线，从而大致判断因变量与自变量之间是否存在明显的线性关系。添加拟合线的方法在协方差分析中有提及。例子如下图：</p>

<p><figure><img src="/image/SPSS/一元回归-散点图.png" alt=""></figure></p>

<p>对于根据散点图做出的初步判断，可以使用<code>分析-相关-双变量</code>来验证线性相关性。例子如下图：</p>

<p><figure><img src="/image/SPSS/一元回归-相关性检验.png" alt=""></figure></p>

<p>在确定自变量与因变量存在线性相关关系后，可以使用<code>分析-回归-线性</code>来建立线性回归模型。分别将因变量与自变量加入对应框中，并在<code>统计量</code>选框中勾选置信区间选项。分析会生成三个表格。</p>

<p><figure><img src="/image/SPSS/一元回归-拟合优度.png" alt=""></figure></p>

<p>这个表格给出了模型的<span  class="math">\(R^2\)</span>值，反映了模型的拟合优度。通常我们使用调整R方作为判断依据。</p>

<p><figure><img src="/image/SPSS/一元回归-单因素.png" alt=""></figure></p>

<p>这个表格进行了单因素方差分析，其可以判断回归模型可解释的变差相对于总变差来说是否显著。这部分对应的是回归方程的显著性检验。</p>

<p><figure><img src="/image/SPSS/一元回归-回归系数检验.png" alt=""></figure></p>

<p>这个表格给出了各个自变量的回归系数以及对应的显著性。回归系数的预测值在蓝色部分，回归系数显著性检验的Sig在黄色部分。由于原假设为回归系数为0，因此当Sig值小于0.05时，则可以认为当前自变量与因变量存在显著线性关系。红色部分时标准化的回归系数（如图，表示人均收入增长1个单位则人均食品支出增长0.921个单位）。</p>
</article><section class="article labels"><a class="category" href=/categories/spss/>SPSS</a></section><section class="article navigation"><p><a class="link" href="/post/%E8%99%9A%E6%8B%9F%E5%8F%98%E9%87%8F/"><span class="li">&larr;</span>SPSS-多元回归之虚拟变量</a></p><p><a class="link" href="/post/%E9%80%90%E6%AD%A5%E5%9B%9E%E5%BD%92/"><span class="li">&rarr;</span>SPSS-多元回归之逐步回归</a class="link">
    </p></section></div><code class="html"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js"integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js"integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe"crossorigin="anonymous"onload="renderMathInElement(document.body,{delimiters: [{left: '$$', right: '$$', display: true},{left: '$', right: '$', display: false}]});"></script>
</code>
<section id="footer" class="footer"><div class="footer-wrap">
    <p class="copyright">©2020 <a href="https://github.com/Sayuri2333" target="_blank">Sayuri2333</a>.</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div>
</section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script></div>
</body>

</html>