<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.89.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>SPSS-协方差分析&nbsp;&ndash;&nbsp;SayuriBlog</title><link rel="stylesheet" href="/css/core.min.648a6d12e2a3dde16e849ff7df9be3ae5560eafe1a16f581e9555eea238e863fe56d7308f54ae31f49106dd309b237eb.css" integrity="sha384-ZIptEuKj3eFuhJ/335vjrlVg6v4aFvWB6VVe6iOOhj/lbXMI9UrjH0kQbdMJsjfr"><body>
    <div class="base-body"><code class="html"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css"/></code>
<section id="header" class="site header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><img class="site logo" src="/img/logo.jpg" alt /><span class="site name">SayuriBlog</span></a></span>
        <span class="header right-side"></span></div></section><div id="content"><section class="article header">
    <h1 class="article title">SPSS-协方差分析</h1><p class="article date">Thursday, April 8, 2021</p></section><article class="article markdown-body"><h3 id="协方差分析">协方差分析</h3>

<p>在许多实际问题中，有些控制因素<strong>往往很难人为控制</strong>，但他们确<strong>会对观察变量产生较为显著地影响</strong>。在方差分析中，如果忽略这些因素的存在而单纯去分析其他因素对观测变量的影响，往往会夸大或缩小其他因素的影响作用，使分析结论不准确。</p>

<p>为了更加准确地研究控制变量对观测变量影响，应尽量排除其他可能因素对分析结论的影响。协方差分析<strong>将某些难以人为控制的因素作为协变量</strong>，<strong>在排除协变量对观测变量的影响条件下</strong>，分析控制变量对观测变量的作用，从而更加准确地对控制因素进行评价。</p>

<h4 id="协方差分析基本思想">协方差分析基本思想</h4>

<p>基本思想：观测变量的变动受四个方面的影响</p>

<ul>
<li>控制变量独立的影响</li>
<li>控制变量的交互作用</li>
<li>协变量作用</li>
<li>随机因素的作用</li>
</ul>

<p>协方差分析扣除协变量的影响后，再分析控制变量对观测变量的影响。</p>

<h4 id="协方差分析的假设与模型">协方差分析的假设与模型</h4>

<p>协方差分析的原假设是协变量对观测变量的线性影响不显著的。其通过F统计量来判断，F大，则说明协变量是引起观测变量变化的因素之一，观测变量的变动可以部分地由协变量来线性解释。反之，协变量对观测变量变化无影响。</p>

<p>单因素协方差的数学模型如下：</p>

<p><span  class="math">\[
x_{ij} = \mu + \alpha_i + \beta z_{ij}+ \varepsilon_{ij}
\]</span></p>

<p>其中<span  class="math">\(x_{ij}\)</span>是水平<span  class="math">\(A_i\)</span>下第<span  class="math">\(j\)</span>次试验的因变量的观察值；<span  class="math">\(\mu\)</span>为因变量的理论值，<span  class="math">\(\alpha_i\)</span>为控制变量水平<span  class="math">\(A_i\)</span>对实验结果产生的影响。<span  class="math">\(z_{ij}\)</span>为水平<span  class="math">\(A_i\)</span>下第<span  class="math">\(j\)</span>次实验的样本对应的<strong>协变量的值</strong>；<span  class="math">\(\beta\)</span>为回归系数，<span  class="math">\(\varepsilon_{ij}\)</span>为随机误差。</p>

<p>在协方差分析中，协变量一般是连续变量。其中，因变量和协变量之间有显著的线性关系(研究假设)。同时，协方差分析中要求协变量与控制变量不存在交互作用，即协变量与控制变量相互独立，满足回归的同质性假设。</p>

<h4 id="回归同质性假设">回归同质性假设</h4>

<p>回归同质性假设说明了<strong>协变量与因变量的关联性在控制变量的各水平组内是相同的</strong>，对于回归同质性假设检验是执行协方差分析的必要工作。</p>

<h4 id="spss中的协方差分析前的准备">SPSS中的协方差分析前的准备</h4>

<p>在进行协方差分析之前需要做好两个准备：检验协变量与因变量之间的线性关系，以及判断数据是否符合回归同质性假设。</p>

<p>检验因变量与协变量之间的线性关系时，需要在控制变量的同一水平内进行。可以按照控制变量拆分数据集，并分组进行相关分析，也可以画图，通过<code>图形-图表构建程序</code>中的分组散点图，将因变量和协变量分别作为x,y轴，将控制变量作为分组依据画图。例子入下图所示。</p>

<p><figure><img src="/image/SPSS/协方差分析-分组散点图.png" alt=""></figure></p>

<p>画好图后，可以在输出报告中右键单击图，选择<code>编辑内容-在单独窗口中</code>，通过点击上方的<code>添加子组拟合线</code>为图上各组散点图添加拟合线。如下图所示。</p>

<p><figure><img src="/image/SPSS/协方差分析-子组拟合线.png" alt=""></figure></p>

<p>假如在控制变量的不同水平下，协变量与因变量都存在较强的线性关系，且各个分组拟合直线的斜率都基本相同的话，可以认为协变量与因变量之间存在线性关系，且初步认为数据符合回归同质性假设。</p>

<p>进行回归同质性假设，可以使用<code>分析-一般线性模型-单变量</code>进行检验。分别将因变量，控制变量以及协变量填入对应选框中，再点击右上角<code>模型</code>按钮，在新页面中的<code>指定模型</code>处点击设定，并将控制变量、协变量以及他们的交互作用填入模型中。在生成的报告中我们可以观察交互效应的Sig值。如果Sig值大于0.05，则可以认为各水平上的协变量和自变量不存在交互作用。</p>

<p>进行上述检测后才能进行协方差分析。</p>

<h4 id="spss中的协方差分析">SPSS中的协方差分析</h4>

<p>同样使用<code>分析-一般线性模型-单变量</code>进行检验。将模型中的交互项移除，仅使用控制变量与协变量进行分析即可。</p>

<p><figure><img src="/image/SPSS/协方差分析-报告图.png" alt=""></figure></p>

<p>sl代表饲料，为控制变量，wyq代表喂养前体重，为协变量，因变量为喂养后体重。从报告图中可以看出，协变量对应的F = 88.813，p = 0.000，这说明协变量（生猪的体重）与 观测变量（生猪的体重增长）之间存在可解释的线性关系。即喂养前生猪的体重对生猪体重增加有显著影响，同样在排除了喂养前体重的影响下，不同饲料对生猪体重的增加也存在显著差异(F=57.987,p=0.0)。</p>

<p>我们可以将协方差分析的结果与不考虑协变量的单因素方差分析结果进行对比。</p>

<p><figure><img src="/image/SPSS/协方差分析-对比检验.png" alt=""></figure></p>

<p>可以看出，相比于不考虑协变量的单因素方差分析结果，协方差分析中模型的随机误差从1238.375减少到227.615，模型的调整后的R方从0.469上升到了0.898，证明将喂养前体重作为协变量引入模型是非常正确的选择，能够大幅提高模型的拟合优度。同时，饲料的可解释变差由1317.583减小为707.219，这是由于扣除了喂养前体重的影响造成的。</p>

<p>在<code>分析-一般线性模型-单变量</code>点击绘制，我们可以绘制在不同控制变量水平下因变量的均值差异。在不考虑协变量的单因素方差分析结果中，通过将控制变量sl（饲料）添加入水平轴，我们可以绘制均值图如下：</p>

<p><figure><img src="/image/SPSS/协方差分析-单因素均值图.png" alt=""></figure></p>

<p>根据均值排序，最好饲料2，最差饲料1，饲料3与饲料2差距较小。效果排名2-3-1。</p>

<p>在考虑了协变量的协方差分析的结果中，可以通过上述一样的步骤获得均值图如下：</p>

<p><figure><img src="/image/SPSS/协方差分析-协方差均值图.png" alt=""></figure></p>

<p>在排除生猪自身体重条件后，饲料的优劣排名为2-1-3。可见，排除协变量影响后的分析结果并不等同于前面的分析。通过绘制喂养前体重与饲料种类的分组箱线图可以看出，第三组生猪喂养前的体重明显高于第一组，因此第三组生猪增重的幅度本来就比第一组生猪的幅度要更大。</p>

<h4 id="协方差分析总结">协方差分析总结</h4>

<p><strong>核心目的</strong>：需要尽力排除非控制因素的干扰和影响，从而准确地获得控制因素的实验效应。</p>

<p><strong>方法</strong>：在做两组或多组均数间的比较前，用直线回归找出各组因变量Y和协变量X之间的数量关系，<strong>求得假定X相等时的修正均值</strong>，<strong>再利用方差分析比较修正均值</strong>之间的差别。该方法是定量分析中控制混杂因素的重要手段之一。</p>
</article><section class="article labels"><a class="category" href=/categories/spss/>SPSS</a></section><section class="article navigation"><p><a class="link" href="/post/%E5%A4%9A%E5%85%83%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/"><span class="li">&larr;</span>SPSS-多元回归分析</a></p><p><a class="link" href="/post/%E5%8D%95%E5%9B%A0%E7%B4%A0%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90/"><span class="li">&rarr;</span>SPSS-单因素方差分析</a class="link">
    </p></section></div><code class="html"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js"integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js"integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe"crossorigin="anonymous"onload="renderMathInElement(document.body,{delimiters: [{left: '$$', right: '$$', display: true},{left: '$', right: '$', display: false}]});"></script>
</code>
<section id="footer" class="footer"><div class="footer-wrap">
    <p class="copyright">©2020 <a href="https://github.com/Sayuri2333" target="_blank">Sayuri2333</a>.</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div>
</section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script></div>
</body>

</html>